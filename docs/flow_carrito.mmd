%% generated by generate_drawio.py v3.2
flowchart LR
  subgraph carrito
    carrito_CartScreen__add_to_cart[_add_to_cart()]
    carrito_CartScreen__build_ui[_build_ui()]
    carrito_CartScreen__chg_qty[_chg_qty()]
    carrito_CartScreen__del_item[_del_item()]
    carrito_CartScreen__finalize_order[_finalize_order()]
    carrito_CartScreen__go_back[_go_back()]
    carrito_CartScreen__load_draft[_load_draft()]
    carrito_CartScreen__persist_draft[_persist_draft()]
    carrito_CartScreen__pick_product[_pick_product()]
    carrito_CartScreen__refresh_totals[_refresh_totals()]
    carrito_CartScreen__render_cart[_render_cart()]
    carrito_CartScreen__suggest[_suggest()]
    carrito_CartScreen__sync_height[_sync_height()]
    carrito_CartScreen__wrap_button[_wrap_button()]
    carrito_CartScreen__wrap_label[_wrap_label()]
    carrito_CartScreen_on_pre_enter[on_pre_enter()]
    carrito__db_path[_db_path()]
    carrito__ensure_tables[_ensure_tables()]
    carrito__price_to_int[_price_to_int()]
  end
  db_todoferre_db((todoferre.db)):::db
  carrito_CartScreen__add_to_cart --> carrito_<call>
  carrito_CartScreen__add_to_cart --> carrito_CartScreen__persist_draft
  carrito_CartScreen__add_to_cart --> carrito_CartScreen__render_cart
  carrito_CartScreen__add_to_cart --> carrito_int
  carrito_CartScreen__build_ui --> carrito_<call>
  carrito_CartScreen__build_ui --> carrito_CartScreen__finalize_order
  carrito_CartScreen__build_ui --> carrito_CartScreen__suggest
  carrito_CartScreen__build_ui --> carrito_CartScreen_add_widget
  carrito_CartScreen__build_ui --> carrito_CartScreen_clear_widgets
  carrito_CartScreen__build_ui --> carrito__go_back
  carrito_CartScreen__build_ui --> carrito_add_widget
  carrito_CartScreen__build_ui --> kivy_BoxLayout
  carrito_CartScreen__build_ui --> kivy_Button
  carrito_CartScreen__build_ui --> kivy_GridLayout
  carrito_CartScreen__build_ui --> kivy_Label
  carrito_CartScreen__build_ui --> kivy_ScrollView
  carrito_CartScreen__build_ui --> kivy_TextInput
  carrito_CartScreen__chg_qty --> carrito_CartScreen__persist_draft
  carrito_CartScreen__chg_qty --> carrito_CartScreen__render_cart
  carrito_CartScreen__chg_qty --> carrito_len
  carrito_CartScreen__chg_qty --> carrito_max
  carrito_CartScreen__del_item --> carrito_<call>
  carrito_CartScreen__del_item --> carrito_CartScreen__persist_draft
  carrito_CartScreen__del_item --> carrito_CartScreen__render_cart
  carrito_CartScreen__del_item --> carrito_len
  carrito_CartScreen__finalize_order --> carrito_<call>
  carrito_CartScreen__finalize_order --> carrito__db_path
  carrito_CartScreen__finalize_order --> carrito__ensure_tables
  carrito_CartScreen__finalize_order --> carrito_close
  carrito_CartScreen__finalize_order --> carrito_commit
  carrito_CartScreen__finalize_order --> carrito_count
  carrito_CartScreen__finalize_order --> carrito_cursor
  carrito_CartScreen__finalize_order --> carrito_execute
  carrito_CartScreen__finalize_order --> carrito_fetchone
  carrito_CartScreen__finalize_order --> carrito_int
  carrito_CartScreen__finalize_order --> carrito_len
  carrito_CartScreen__finalize_order --> carrito_print
  carrito_CartScreen__finalize_order --> carrito_round
  carrito_CartScreen__finalize_order --> carrito_sum
  carrito_CartScreen__finalize_order --> kivy_NoTransition
  carrito_CartScreen__finalize_order --> random_randint
  carrito_CartScreen__finalize_order --> sqlite3_connect
  carrito_CartScreen__finalize_order --> time_time
  carrito_CartScreen__go_back --> kivy_NoTransition
  carrito_CartScreen__load_draft --> carrito_CartScreen__build_ui
  carrito_CartScreen__load_draft --> carrito_CartScreen__render_cart
  carrito_CartScreen__load_draft --> carrito__db_path
  carrito_CartScreen__load_draft --> carrito_close
  carrito_CartScreen__load_draft --> carrito_cursor
  carrito_CartScreen__load_draft --> carrito_execute
  carrito_CartScreen__load_draft --> carrito_fetchone
  carrito_CartScreen__load_draft --> carrito_get
  carrito_CartScreen__load_draft --> carrito_int
  carrito_CartScreen__load_draft --> json_loads
  carrito_CartScreen__load_draft --> sqlite3_connect
  carrito_CartScreen__persist_draft --> carrito__db_path
  carrito_CartScreen__persist_draft --> carrito__ensure_tables
  carrito_CartScreen__persist_draft --> carrito_close
  carrito_CartScreen__persist_draft --> carrito_commit
  carrito_CartScreen__persist_draft --> carrito_cursor
  carrito_CartScreen__persist_draft --> carrito_execute
  carrito_CartScreen__persist_draft --> carrito_int
  carrito_CartScreen__persist_draft --> json_dumps
  carrito_CartScreen__persist_draft --> sqlite3_connect
  carrito_CartScreen__persist_draft --> time_time
  carrito_CartScreen__pick_product --> carrito_CartScreen__add_to_cart
  carrito_CartScreen__refresh_totals --> carrito_<call>
  carrito_CartScreen__refresh_totals --> carrito_int
  carrito_CartScreen__refresh_totals --> carrito_round
  carrito_CartScreen__refresh_totals --> carrito_sum
  carrito_CartScreen__render_cart --> carrito_<call>
  carrito_CartScreen__render_cart --> carrito_CartScreen__chg_qty
  carrito_CartScreen__render_cart --> carrito_CartScreen__del_item
  carrito_CartScreen__render_cart --> carrito_CartScreen__refresh_totals
  carrito_CartScreen__render_cart --> carrito_CartScreen__sync_height
  carrito_CartScreen__render_cart --> carrito_CartScreen__wrap_label
  carrito_CartScreen__render_cart --> carrito_add_widget
  carrito_CartScreen__render_cart --> carrito_bind
  carrito_CartScreen__render_cart --> carrito_enumerate
  carrito_CartScreen__render_cart --> kivy_BoxLayout
  carrito_CartScreen__render_cart --> kivy_Button
  carrito_CartScreen__render_cart --> kivy_dp
  carrito_CartScreen__suggest --> carrito_<call>
  carrito_CartScreen__suggest --> carrito_CartScreen__pick_product
  carrito_CartScreen__suggest --> carrito_CartScreen__wrap_button
  carrito_CartScreen__suggest --> carrito__db_path
  carrito_CartScreen__suggest --> carrito__price_to_int
  carrito_CartScreen__suggest --> carrito_close
  carrito_CartScreen__suggest --> carrito_cursor
  carrito_CartScreen__suggest --> carrito_execute
  carrito_CartScreen__suggest --> carrito_fetchall
  carrito_CartScreen__suggest --> carrito_len
  carrito_CartScreen__suggest --> sqlite3_connect
  carrito_CartScreen__sync_height --> carrito_max
  carrito_CartScreen__sync_height --> kivy_dp
  carrito_CartScreen__wrap_button --> carrito_bind
  carrito_CartScreen__wrap_button --> carrito_max
  carrito_CartScreen__wrap_button --> carrito_on_release
  carrito_CartScreen__wrap_button --> carrito_setattr
  carrito_CartScreen__wrap_button --> kivy_Button
  carrito_CartScreen__wrap_button --> kivy_dp
  carrito_CartScreen__wrap_label --> carrito_bind
  carrito_CartScreen__wrap_label --> carrito_max
  carrito_CartScreen__wrap_label --> carrito_setattr
  carrito_CartScreen__wrap_label --> kivy_Label
  carrito_CartScreen__wrap_label --> kivy_dp
  carrito_CartScreen_on_pre_enter --> carrito_CartScreen__build_ui
  carrito_CartScreen_on_pre_enter --> carrito_CartScreen__load_draft
  carrito_CartScreen_on_pre_enter --> carrito_CartScreen__refresh_totals
  carrito_CartScreen_on_pre_enter --> carrito__ensure_tables
  carrito_CartScreen_on_pre_enter --> carrito_get
  carrito_CartScreen_on_pre_enter --> carrito_getattr
  carrito_CartScreen_on_pre_enter --> kivy_get_running_app
  carrito__db_path --> carrito_<call>
  carrito__ensure_tables --> carrito__db_path
  carrito__ensure_tables --> carrito_close
  carrito__ensure_tables --> carrito_commit
  carrito__ensure_tables --> carrito_cursor
  carrito__ensure_tables --> carrito_execute
  carrito__ensure_tables --> sqlite3_connect
  carrito__price_to_int --> carrito_int
  carrito__price_to_int --> carrito_isinstance
  carrito__price_to_int --> carrito_str
  carrito__price_to_int --> re_sub
  carrito__ensure_tables -- |CREATE| --> db_todoferre_db
  carrito__ensure_tables -- |CREATE| --> db_todoferre_db
  carrito__ensure_tables -- |CREATE| --> db_todoferre_db
  carrito__ensure_tables -- |CREATE| --> db_todoferre_db
  carrito__ensure_tables -- |CREATE| --> db_todoferre_db
  carrito__ensure_tables -- |CREATE| --> db_todoferre_db
  carrito__ensure_tables -- |CREATE| --> db_todoferre_db
  carrito__ensure_tables -- |CREATE| --> db_todoferre_db
  carrito_CartScreen__suggest -- |SELECT| --> db_todoferre_db
  carrito_CartScreen__suggest -- |SELECT| --> db_todoferre_db
  carrito_CartScreen__persist_draft -- |INSERT| --> db_todoferre_db
  carrito_CartScreen__persist_draft -- |INSERT| --> db_todoferre_db
  carrito_CartScreen__load_draft -- |SELECT| --> db_todoferre_db
  carrito_CartScreen__load_draft -- |SELECT| --> db_todoferre_db
  carrito_CartScreen__finalize_order -- |SELECT| --> db_todoferre_db
  carrito_CartScreen__finalize_order -- |SELECT| --> db_todoferre_db
  carrito_CartScreen__finalize_order -- |SQL| --> db_todoferre_db
  carrito_CartScreen__finalize_order -- |SQL| --> db_todoferre_db
  carrito_CartScreen__finalize_order -- |INSERT| --> db_todoferre_db
  carrito_CartScreen__finalize_order -- |INSERT| --> db_todoferre_db
  carrito_CartScreen__finalize_order -- |SELECT| --> db_todoferre_db
  carrito_CartScreen__finalize_order -- |SELECT| --> db_todoferre_db
  carrito_CartScreen__finalize_order -- |INSERT| --> db_todoferre_db
  carrito_CartScreen__finalize_order -- |INSERT| --> db_todoferre_db
  carrito_CartScreen__finalize_order -- |DELETE| --> db_todoferre_db
  carrito_CartScreen__finalize_order -- |DELETE| --> db_todoferre_db
classDef db fill:#ffdede,stroke:#d43c3c;